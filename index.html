<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Mac G4 - Mac OS X Panther</title>
    
    <script src="coi-serviceworker.js"></script>

    <style>
        body {
            margin: 0;
            background-color: #1a1a1a;
            color: #eee;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }
        .mac-container {
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border-radius: 12px;
            overflow: hidden;
            background: #000;
            line-height: 0;
        }
        .status-bar {
            margin-top: 15px;
            font-size: 14px;
            color: #888;
        }
    </style>
</head>
<body>

    <div class="mac-container">
        <iframe 
            id="mac-iframe"
            src="https://infinitemac.org/embed?disk=Mac+OS+X+10.3&machine=Power+Macintosh+G4+%28PCI+Graphics%29&memory=256&apple_talk=false&auto_pause=true"
            width="1024"
            height="768"
            allow="cross-origin-isolated"
            style="border: none;">
        </iframe>
    </div>

    <div class="status-bar" id="status">
        Detecting Performance Mode...
    </div>

    <script>
        // Check if the Service Worker successfully enabled High Performance
        window.onload = function() {
            const statusMsg = document.getElementById('status');
            if (window.crossOriginIsolated) {
                statusMsg.innerHTML = "✅ <strong>High Performance Mode Active</strong> (SharedArrayBuffer Enabled)";
                statusMsg.style.color = "#4CAF50";
            } else {
                statusMsg.innerHTML = "⚠️ Running in Fallback Mode (Slower). Refreshing might help.";
                statusMsg.style.color = "#FFC107";
            }
        };
    </script>
</body>
</html>